(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{MPtC:function(e,a,t){"use strict";t.r(a),t.d(a,"_frontmatter",(function(){return b})),t.d(a,"default",(function(){return m}));var n=t("wx14"),c=t("zLVn"),s=(t("q1tI"),t("7ljp")),o=t("WHYo"),b=(t("qKvR"),{}),p={_frontmatter:b},r=o.a;function m(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(s.b)(r,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(s.b)("p",null,"Some times the performance of Angular1 applications\nsuddenly drops.\nMany times it is due to ngClass,\nor while using scope: '=' in our directives.\nHere I present a simple optimization\nthat ensures the best performance."),Object(s.b)("div",{className:"gatsby-highlight","data-language":"html"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-html"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-html"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),"i")," ",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-name"}),"class"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-value"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation attr-equals"}),"="),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"'),"icon",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"'))," ",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-name"}),"ng-class"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-value"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation attr-equals"}),"="),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"'),"{friendly: user.friends, male: user.isMale}",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"')),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),"...",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"</"),"i"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"<"),"i")," ",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-name"}),"class"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-value"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation attr-equals"}),"="),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"'),"icon",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"'))," ",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-name"}),"ng-class"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token attr-value"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation attr-equals"}),"="),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"'),"{friendly: !!user.friends, male: user.isMale}",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),'"')),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">")),"...",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token tag"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token tag"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"</"),"i"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),">"))))),Object(s.b)("h2",null,"What is $watch?"),Object(s.b)("p",null,"Angular updates views by observing models and expressions\nthrough ",Object(s.b)("em",{parentName:"p"},"$watch"),":"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"$scope",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"$watch"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"whatToWatch",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"onChange"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token parameter"}),"newValue",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),",")," oldValue"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// react to the change"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," objectEquality",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"$watch parameters are the followings:"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"whatToWatch"),": $watch will track changes in this expression,"),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"onChange"),": angular execute this function each time that the value changes,"),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"objectEquality"),": it describes which change will trigger onChange. ")),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"ObjectEquality")," holds the performance key.\nIt only has two valid values: ",Object(s.b)("em",{parentName:"p"},"true")," or ",Object(s.b)("em",{parentName:"p"},"false"),"."),Object(s.b)("h3",null,"$watch(expr, onChange, false)"),Object(s.b)("p",null,"The algorithm is the following:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," oldValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"onDigest"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," newValue ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," expr",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"newValue ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"!==")," oldValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// compare new and old"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"onChange"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"newValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," oldValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n    oldValue ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," newValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"          ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// save new value"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)("p",null,"It is the fastest $watch.\nIt is because the comparison\n(compare new and old) is the not-equal operator,\nand copy (save new value) is an assignation."),Object(s.b)("p",null,"But it have a risk: if the value is an object or an array\nit calls onChange only when the object or array is replaced.\nIt ignores changes in fields or element changes."),Object(s.b)("h3",null,"$watch(expr, onChange, true)"),Object(s.b)("p",null,"The algorithm is the following: "),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," oldValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"function")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"onDigest"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," newValue ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," expr",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"if")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"!"),"angular",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"equals"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"newValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," oldValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// compare new and old"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"onChange"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"newValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," oldValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n    oldValue ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," angular",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"copy"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"newValue",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"          ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"// save new value"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)("p",null,"It is the slowest $watch.\nIt uses ",Object(s.b)("em",{parentName:"p"},"angular.equals")," for the comparison,\nand ",Object(s.b)("em",{parentName:"p"},"angular.copy")," to save the value.\nBut it detects all changes,\nincluding changes in object fields or array elements."),Object(s.b)("h2",null,"Complex objects and $watch...true"),Object(s.b)("p",null,"Let's imagine an object as the following:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," david ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  name",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'David Rodenas'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  friends",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"jairo",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," janton",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," moraleda",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," natalia",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," sarek",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," victor",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"This object contains friends field.\nThis field is an array that contains other users.\nEach user may have potentially other friends."),Object(s.b)("h3",null,"Six degrees of separation"),Object(s.b)("p",null,Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Six_degrees_of_separation",target:"_blank",rel:"nofollow noopener noreferrer"}),"Six degrees of separation"),"\ntheory tell us that we can reach all our users just following friends relationships."),Object(s.b)("div",{className:"gatsby-highlight","data-language":"nomnoml"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-nomnoml"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-nomnoml"}),"#direction: right\n\n[<actor>you]\n[you] - [<actor>friend1]\n[you] - [<actor>friend2]\n[you] - [<actor>friend ...]\n[you] - [<actor>friend4]\n[friend2] - [<actor>friendof1]\n[friend2] - [<actor>friendof2]\n[friend2] - [<actor>fof ...]\n[friend2] - [<actor>friendofn]\n[friendofn] - [<actor>friendofof1]\n[friendofn] - [<actor>friendofof2]\n[friendofn] - [<actor>fofof...]\n[friendofn] - [<actor>friendofofn]\n[friendofof1] - [<actor>friendofofof1]\n[friendofof1] - [<actor>friendofofof2]\n[friendofof1] - [<actor>fofofof ...]\n[friendofof1] - [<actor>friendofofofn]"))),Object(s.b)("h3",null,"Complex object copy"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," oldDavid ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," angular",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"copy"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"david",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"It creates ",Object(s.b)("em",{parentName:"p"},"oldDavid")," which is a copy of ",Object(s.b)("em",{parentName:"p"},"david"),"\nbut also a copy of each of its friends,\nfriends of friends, and all users in our domain. "),Object(s.b)("p",null,"Thus, this copy is very expensive operation."),Object(s.b)("h3",null,"Complex object equals"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," hasChanges ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"!"),"angular",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token function"}),"equals"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"("),"david",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," oldDavid",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"It compares each property of both, ",Object(s.b)("em",{parentName:"p"},"oldDavid")," and ",Object(s.b)("em",{parentName:"p"},"david"),".\nIf a property is an array, it compares each element.\nIf elements are an object it compares once again value by value.\nAnd so on.\nIt eventually will check that each user in our domain\nhas the same name and friends."),Object(s.b)("p",null,"This, this equals operations is very expensive."),Object(s.b)("h3",null,"Other complex objects"),Object(s.b)("p",null,"There are lots of other objects that are complex. "),Object(s.b)("p",null,"Library example:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," davidUser ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  name",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'David Rodenas'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  loans",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"book",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," theGoodParts",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," expires",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2016/11/12'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"book",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," aDeepnessInTheSky",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," expires",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2016/10/21'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," cleanCodeBook ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  name",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'Clean Code'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  author",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'Robert Cecil Martin'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  history",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," oriol",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," date",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2015/06/08'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," lluis",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," date",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2015/09/24'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," david",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," date",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2016/02/12'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," granados",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," date",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2016/04/01'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"Here are not friends, but a user has books, books has more users, etc.\nIt will potentially copy all objects in our domain."),Object(s.b)("h2",null,"Ids instead of references"),Object(s.b)("p",null,"Replacing object references by ids\ncan make objects less complex."),Object(s.b)("h3",null,"Friends example"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," david ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  id",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#david'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  name",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'David Rodenas'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  friends",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#jairo'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#janton'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#moraleda'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#natalia'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#sarek'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#victor'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("h3",null,"Library example"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," davidUser ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  id",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#david'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  name",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'David Rodenas'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  loans",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"book",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#theGoodParts'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," expires",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2016/11/12'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"book",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#aDeepnessInTheSky'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," expires",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2016/10/21'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," cleanCodeBook ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  id",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#cleanCode'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  name",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'Clean Code'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  author",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'Robert Cecil Martin'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  history",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#oriol'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," date",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2015/06/08'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#lluis'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," date",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2015/09/24'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#david'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," date",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2016/02/12'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'#granados'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),",")," date",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"'2016/04/01'"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("h3",null,"Copy and equals"),Object(s.b)("p",null,"There are no direct references to other objects when using ids."),Object(s.b)("p",null,"Given friends example, ",Object(s.b)("em",{parentName:"p"},"angular.copy")," create another object, with\nfields ",Object(s.b)("em",{parentName:"p"},"id"),", ",Object(s.b)("em",{parentName:"p"},"name")," with the same value, and a field ",Object(s.b)("em",{parentName:"p"},"friends"),"\nwith a copy of the array with the same values."),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"angular.equals")," check that both objects have the same fields,\n",Object(s.b)("em",{parentName:"p"},"id")," and ",Object(s.b)("em",{parentName:"p"},"name")," has the same values, and field ",Object(s.b)("em",{parentName:"p"},"friends"),"\nhas the same values in the same order in both objects."),Object(s.b)("h2",null,"Accelerate ngClass"),Object(s.b)("p",null,"ngClass uses ",Object(s.b)("em",{parentName:"p"},"$watch-true"),".\nIt needs to track changes inside an object."),Object(s.b)("h3",null,"Problem"),Object(s.b)("p",null,"Given the example:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),"i ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"class"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"icon"')," ng",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"-"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"class"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"{friendly: user.friends}"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),"i",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">")))),Object(s.b)("p",null,"ngClass watches the expression:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"friendly",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," user",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"."),"friends",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)("p",null,"It copies and compares all user friends,\nfriend of friends, ... which is really expensive."),Object(s.b)("h3",null,"What we want"),Object(s.b)("p",null,"What we really meant to write was:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),"i ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"class"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"icon"')," ng",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"-"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"class"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"{friendly: user.hasFriends()}"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),"i",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">")))),Object(s.b)("p",null,"In such case ",Object(s.b)("em",{parentName:"p"},"ngClass")," would see one of the two following values:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," caseAddClass ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"friendly",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," caseRemoveClass ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"friendly",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"There is no trace of the user object.\nIt will not copy neither compare user values, friends, ...\nNo need to replace references by ids."),Object(s.b)("h3",null,"Double negation notation"),Object(s.b)("p",null,"It is not always feasible to add new methods or properties\nlike ",Object(s.b)("em",{parentName:"p"},"user.hasFriends"),"."),Object(s.b)("p",null,"In such cases we can use double negation ",Object(s.b)("code",Object(n.a)({parentName:"p"},{className:"language-text"}),"!!")," to a\n",Object(s.b)("em",{parentName:"p"},"truthy"),"/",Object(s.b)("em",{parentName:"p"},"falsy")," value into a ",Object(s.b)("em",{parentName:"p"},"true"),"/",Object(s.b)("em",{parentName:"p"},"false"),"."),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),"i ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"class"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"icon"')," ng",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"-"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"class"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"{friendly: !!user.friends}"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"..."),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"<"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"/"),"i",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),">")))),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"ngClass")," see one of the following values:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(s.b)("pre",Object(n.a)({parentName:"div"},{className:"language-javascript"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," caseAddClass ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"friendly",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"var")," caseRemoveClass ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"friendly",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("p",null,"Thus, no complex object copy or comparison."),Object(s.b)("h2",null,"Comparison"),Object(s.b)("h3",null,"Implementation oportunity"),Object(s.b)("p",null,"Use ids instead of references is not always possible.\nThere are cases where an object will contain its own entities.\nFor example: a todo list may contain its todo objects."),Object(s.b)("p",null,"Double negation notation is always possible to use."),Object(s.b)("h3",null,"Implementation cost"),Object(s.b)("p",null,"Using ids instead of references ensures that\n$watch will never do a large copy or comparison.\nBut it may need a deep refactor of the application.\nIt makes it one of the most difficult possible solutions."),Object(s.b)("p",null,"Double negation notation is simple,\njust look for ngClass directives and add a double\nnegation operator before each object."),Object(s.b)("h3",null,"Programmer reliability"),Object(s.b)("p",null,"Using ids instead of references will always work.\nProgrammer has to do nothing but use it.\nIt ensures that in any case accidentally the programmer\nwill make $watch to copy and compare all domain objects. "),Object(s.b)("p",null,"Using double negation notation is dangerous.\nA programmer may forget use it inside a ngClass,\nwork well the first day, and later, some day\ndiscover that the app starts to behave sluggish."),Object(s.b)("h3",null,"Performance"),Object(s.b)("table",null,Object(s.b)("thead",{parentName:"table"},Object(s.b)("tr",{parentName:"thead"},Object(s.b)("th",Object(n.a)({parentName:"tr"},{align:null})),Object(s.b)("th",Object(n.a)({parentName:"tr"},{align:"right"}),"Digest-loop time"))),Object(s.b)("tbody",{parentName:"table"},Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"No double negation"),Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:"right"}),"1.40ms")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"With double negation"),Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:"right"}),"0.02ms")))),Object(s.b)("p",null,"Time without double negation varies:\nhow big is the basic object?\nhow many references it has?\nhow many references have your domain?\nIn some cases I have seen it take more\nthan 30 seconds."),Object(s.b)("p",null,"Double negation notation execution time is constant.\nIt does not matter how big the object is,\nhow complex is our domain, it always will\ntake the same time."),Object(s.b)("h2",null,"Conclusion"),Object(s.b)("p",null,"It is not always possible use ids instead of references.\nBut even using ids instead of references it copies\nthe object and compares it.\nIf the object is complex the performance will suffer.\nIt does not give any guarantee of good performance. "),Object(s.b)("p",null,"Double negation notation is simple,\nalways have a predictable behaviour and good performance.\nThe only problem is the programmer,\nhe may omit some double negation and performance will\nsuffer.\nBut it has a simple solution:\ntime to time, or if performance degrades,\nlook for all ngClass and check double negations,\nif any is missing, just add it."),Object(s.b)("h2",null,"Replicate benchmarks"),Object(s.b)("p",null,"Performance times are obtained using benchpress."),Object(s.b)("p",null,"You can replicate the experiments with\nthe benchpress benchmark inside AngularJS git repo\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/drpicox/angular.js/tree/11d94ab6531c9aca6383f6eb8f23d182ea003d75/benchmarks",target:"_blank",rel:"nofollow noopener noreferrer"}),"ng-class-bp")," . "),Object(s.b)("h2",null,"More information"),Object(s.b)("p",null,"You can consult the official documentation ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.angularjs.org/guide/production#disable-comment-and-css-class-directives",target:"_blank",rel:"nofollow noopener noreferrer"}),"here"),"\nto learn more details."),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"$compile: ",Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"https://docs.angularjs.org/api/ng/service/$compile",target:"_blank",rel:"nofollow noopener noreferrer"}),"https://docs.angularjs.org/api/ng/service/$compile")),Object(s.b)("li",{parentName:"ul"},"$watch: ",Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$watch",target:"_blank",rel:"nofollow noopener noreferrer"}),"https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$watch"))))}m.isMDXComponent=!0},WHYo:function(e,a,t){"use strict";t.d(a,"a",(function(){return p}));t("q1tI");var n=t("7ljp"),c=t("eC7B"),s=t("8rN0"),o=t("m8Tn"),b=t("qKvR");function p(e){var a=e.children,t=e.pageContext.frontmatter.title;return Object(b.a)(o.a,{title:t},Object(b.a)(n.a,{components:s},Object(b.a)(c.a,null,Object(b.a)(s.Container,null,t&&Object(b.a)("h1",null,t),a))))}}}]);
//# sourceMappingURL=component---wiki-angular-js-ng-class-performance-large-objects-mdx-d4dcc8c7e565e2a8eeba.js.map